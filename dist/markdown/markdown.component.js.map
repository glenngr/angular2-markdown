{"version":3,"sources":["../../src/markdown/markdown.component.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAA,EAAW,UAAA,EAAmC,KAAA,EAAM,MAAO,eAAA,CAAgB;AACpF,OAAO,EAAE,IAAA,EAAK,MAAO,eAAA,CAAgB;AACrC,OAAO,EAAE,eAAA,EAAgB,MAAO,oBAAA,CAAqB;AACrD,OAAO,mBAAA,CAAoB;AAG3B;IAOI,2BACY,SAA0B,EAC1B,EAAc,EACd,IAAU;QAFV,cAAS,GAAT,SAAS,CAAiB;QAC1B,OAAE,GAAF,EAAE,CAAY;QACd,SAAI,GAAJ,IAAI,CAAM;QALtB,cAAS,GAAa,EAAE,CAAC;IAMrB,CAAC;IAEL,oCAAQ,GAAR;IAEA,CAAC;IAGD,sBAAI,mCAAI;aAAR,UAAS,KAAY;YACnB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,YAAY,EAAE,CAAC;QACtB,CAAC;;;OAAA;IAGD,sBAAI,mCAAI;aAAR,UAAS,KAAY;YACnB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAC3B,CAAC;;;OAAA;IAGD,WAAW;IACX,wCAAY,GAAZ,UAAa,IAAW;QACtB,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC/D,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;IAC5B,CAAC;IAED;;OAEG;IACH,2CAAe,GAAf;QACE,EAAE,CAAA,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;YACd,IAAI,CAAC,YAAY,EAAE,CAAC;QACtB,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,UAAU,EAAE,CAAC;QACpB,CAAC;IACH,CAAC;IAED,sCAAU,GAAV;QACE,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;QACzD,IAAI,CAAC,EAAE,CAAC,aAAa,CAAC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACnE,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;IAC5B,CAAC;IAED;;OAEG;IACH,wCAAY,GAAZ;QAAA,iBASC;QARG,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC;QAClE,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC;aAChC,SAAS,CAAC,UAAA,IAAI;YACX,KAAI,CAAC,GAAG,GAAG,KAAI,CAAC,IAAI,KAAK,IAAI,GAAG,KAAK,GAAG,KAAI,CAAC,IAAI,GAAG,IAAI,GAAG,IAAI,GAAG,OAAO,GAAG,IAAI,CAAC;YACjF,KAAI,CAAC,EAAE,CAAC,aAAa,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,KAAI,CAAC,OAAO,CAAC,KAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YACjF,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAC9B,CAAC,EACD,UAAA,GAAG,IAAI,OAAA,KAAI,CAAC,WAAW,EAAhB,CAAgB,CAAC,CAAC;IACjC,CAAC;IAED;;OAEG;IACK,uCAAW,GAAnB,UAAoB,KAAU;QAC1B,OAAO,CAAC,KAAK,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAC,CAAC,yBAAyB;QACpE,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,IAAI,KAAK,CAAC,CAAC;IAClD,CAAC;IAED;;OAEG;IACF,mCAAO,GAAP,UAAQ,GAAW;QAAnB,iBAcA;QAbG,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACP,MAAM,CAAC,EAAE,CAAC;QACd,CAAC;QACD,EAAE,CAAC,CAAC,IAAI,CAAC,IAAI,KAAK,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YACnC,IAAI,aAAW,GAAG,KAAK,CAAC;YACxB,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,UAAC,IAAY;gBACpC,EAAE,CAAC,CAAC,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,KAAK,CAAC,CAAC,CAAC;oBAChD,aAAW,GAAG,CAAC,aAAW,CAAC;gBAC/B,CAAC;gBACD,MAAM,CAAC,aAAW,GAAG,IAAI,GAAG,IAAI,CAAC,IAAI,EAAE,CAAC;YAC5C,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAClB,CAAC;QACD,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;IACpC,CAAC;IAED;;OAEG;IACK,oCAAQ,GAAhB,UAAiB,IAAY;QACzB,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;IAC1C,CAAC;IAsBL,wBAAC;AAAD,CAzHA,AAyHC;;AArBM,4BAAU,GAA0B;IAC3C,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;gBACtB,QAAQ,EAAE,qBAAqB;gBAC/B,QAAQ,EAAE,2BAA2B;gBACrC,MAAM,EAAE;oBACJ,2IAEE;iBACL;aACJ,EAAG,EAAE;CACL,CAAC;AACF,kBAAkB;AACX,gCAAc,GAAmE,cAAM,OAAA;IAC9F,EAAC,IAAI,EAAE,eAAe,GAAG;IACzB,EAAC,IAAI,EAAE,UAAU,GAAG;IACpB,EAAC,IAAI,EAAE,IAAI,GAAG;CACb,EAJ6F,CAI7F,CAAC;AACK,gCAAc,GAA2C;IAChE,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;IAC1B,MAAM,EAAE,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE;CACzB,CAAC","file":"markdown.component.js","sourceRoot":"","sourcesContent":["import { Component, ElementRef, OnInit, AfterViewInit, Input } from '@angular/core';\r\nimport { Http } from '@angular/http';\r\nimport { MarkdownService } from './markdown.service';\r\nimport './prism.languages';\r\n\r\n\r\nexport class MarkdownComponent implements OnInit {\r\n    private _path: string;\r\n    private _data: string;\r\n    private _md: any;\r\n    private _ext: string;\r\n    changeLog: string[] = [];\r\n\r\n    constructor(\r\n        private mdService: MarkdownService,\r\n        private el: ElementRef,\r\n        private http: Http\r\n    ) { }\r\n\r\n    ngOnInit() {\r\n\r\n    }\r\n\r\n    \r\n    set path(value:string) {\r\n      this._path = value;\r\n      this.onPathChange();\r\n    }\r\n\r\n    \r\n    set data(value:string) {\r\n      this._data = value;\r\n      this.onDataChange(value);\r\n    }\r\n\r\n\r\n    // on input\r\n    onDataChange(data:string){\r\n      this.el.nativeElement.innerHTML = this.mdService.compile(data);\r\n      Prism.highlightAll(false);\r\n    }\r\n\r\n    /**\r\n     *  After view init\r\n     */\r\n    ngAfterViewInit() {\r\n      if(this._path) {\r\n        this.onPathChange();\r\n      } else {\r\n        this.processRaw();\r\n      }\r\n    }\r\n\r\n    processRaw() {\r\n      this._md = this.prepare(this.el.nativeElement.innerHTML);\r\n      this.el.nativeElement.innerHTML = this.mdService.compile(this._md);\r\n      Prism.highlightAll(false);\r\n    }\r\n\r\n    /**\r\n     * get remote conent;\r\n     */\r\n    onPathChange() {\r\n        this._ext = this._path && this._path.split('.').splice(-1).join();\r\n        this.mdService.getContent(this._path)\r\n            .subscribe(data => {\r\n                this._md = this._ext !== 'md' ? '```' + this._ext + '\\n' + data + '\\n```' : data;\r\n                this.el.nativeElement.innerHTML = this.mdService.compile(this.prepare(this._md));\r\n                Prism.highlightAll(false);\r\n            },\r\n            err => this.handleError);\r\n    }\r\n\r\n    /**\r\n     * catch http error\r\n     */\r\n    private handleError(error: any): Promise<any> {\r\n        console.error('An error occurred', error); // for demo purposes only\r\n        return Promise.reject(error.message || error);\r\n    }\r\n\r\n    /**\r\n     * Prepare string\r\n     */\r\n     prepare(raw: string) {\r\n        if (!raw) {\r\n            return '';\r\n        }\r\n        if (this._ext === 'md' || !this.path) {\r\n            let isCodeBlock = false;\r\n            return raw.split('\\n').map((line: string) => {\r\n                if (this.trimLeft(line).substring(0, 3) === \"```\") {\r\n                    isCodeBlock = !isCodeBlock;\r\n                }\r\n                return isCodeBlock ? line : line.trim();\r\n            }).join('\\n');\r\n        }\r\n        return raw.replace(/\\\"/g, '\\'');\r\n    }\r\n\r\n    /**\r\n     * Trim left whitespace\r\n     */\r\n    private trimLeft(line: string) {\r\n        return line.replace(/^\\s+|\\s+$/g, '');\r\n    }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\r\n    selector: 'markdown,[Markdown]',\r\n    template: '<ng-content></ng-content>',\r\n    styles: [\r\n        `.token.operator, .token.entity, .token.url, .language-css .token.string, .style .token.string {\r\n            background: none;\r\n        }`\r\n    ]\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: MarkdownService, },\n{type: ElementRef, },\n{type: Http, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'path': [{ type: Input },],\n'data': [{ type: Input },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}